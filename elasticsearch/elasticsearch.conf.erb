# ElasticSearch Service
description     "ElasticSearch"
 
start on started sshd
stop on stopped sshd
 
respawn limit 10 5
 
env ES_HOME=/usr/local/elasticsearch
env ES_MIN_MEM=256m
env ES_MAX_MEM=2g
env DAEMON=$ES_HOME/bin/elasticsearch
env NAME=elasticsearch
env LOG_DIR=/var/log/$NAME
env DATA_DIR=/var/lib/$NAME
env WORK_DIR=/tmp/$NAME
env CONFIG_FILE=/etc/$NAME/elasticsearch.yml
env DAEMON_OPTS="-Des.config=$CONFIG_FILE -Des.path.home=$ES_HOME -Des.path.logs=$LOG_DIR -Des.path.data=$DATA_DIR -Des.path.work=$WORK_DIR"

setuid elasticsearch
setgid elasticsearch

exec sh -c "$DAEMON -f $DAEMON_OPTS"

pre-start script
    logger -is "$UPSTART_JOB" "started"
end script

pre-stop script
    logger -is "$UPSTART_JOB" "stopped"
end script

